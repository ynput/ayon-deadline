<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=PluginPreLoad.html><link rel=next href=UnrealEnginePlugins/index.html><link rel=icon href=../../../../../../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.9"><title>UnrealEngine5 - ayon-deadline</title><link rel=stylesheet href=../../../../../../../assets/stylesheets/main.4af4bdda.min.css><link rel=stylesheet href=../../../../../../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../../../../css/custom.css><script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../../../../index.html title=ayon-deadline class="md-header__button md-logo" aria-label=ayon-deadline data-md-component=logo> <img src=../../../../../../../img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-deadline </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> UnrealEngine5 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../../../../index.html title=ayon-deadline class="md-nav__button md-logo" aria-label=ayon-deadline data-md-component=logo> <img src=../../../../../../../img/ay-symbol-blackw-full.png alt=logo> </a> ayon-deadline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../license.md class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../../../../index.html class="md-nav__link "> <span class=md-ellipsis> client </span> </a> <label class="md-nav__link " for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> client </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../../../index.html class="md-nav__link "> <span class=md-ellipsis> ayon_deadline </span> </a> <label class="md-nav__link " for=__nav_3_1_1 id=__nav_3_1_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> ayon_deadline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../abstract_submit_deadline.html class=md-nav__link> <span class=md-ellipsis> abstract_submit_deadline </span> </a> </li> <li class=md-nav__item> <a href=../../../../addon.html class=md-nav__link> <span class=md-ellipsis> addon </span> </a> </li> <li class=md-nav__item> <a href=../../../../constants.html class=md-nav__link> <span class=md-ellipsis> constants </span> </a> </li> <li class=md-nav__item> <a href=../../../../lib.html class=md-nav__link> <span class=md-ellipsis> lib </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../plugins/publish/aftereffects/submit_aftereffects_deadline.html class=md-nav__link> <span class=md-ellipsis> plugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_6 checked> <div class="md-nav__link md-nav__container"> <a href=../../../index.html class="md-nav__link "> <span class=md-ellipsis> repository </span> </a> <label class="md-nav__link " for=__nav_3_1_1_6 id=__nav_3_1_1_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_6_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_6> <span class="md-nav__icon md-icon"></span> repository </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_6_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> custom </span> </a> <label class="md-nav__link " for=__nav_3_1_1_6_1 id=__nav_3_1_1_6_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_3_1_1_6_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_6_1> <span class="md-nav__icon md-icon"></span> custom </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_6_1_1 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> plugins </span> </a> <label class="md-nav__link " for=__nav_3_1_1_6_1_1 id=__nav_3_1_1_6_1_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_3_1_1_6_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_6_1_1> <span class="md-nav__icon md-icon"></span> plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Ayon/Ayon.html class=md-nav__link> <span class=md-ellipsis> Ayon </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../CelAction/CelAction.html class=md-nav__link> <span class=md-ellipsis> CelAction </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../GlobalJobPreLoad.html class=md-nav__link> <span class=md-ellipsis> GlobalJobPreLoad </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../HarmonyAYON/HarmonyAYON.html class=md-nav__link> <span class=md-ellipsis> HarmonyAYON </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_6_1_1_5 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link "> <span class=md-ellipsis> UnrealEngine5 </span> </a> <label class="md-nav__link " for=__nav_3_1_1_6_1_1_5 id=__nav_3_1_1_6_1_1_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=7 aria-labelledby=__nav_3_1_1_6_1_1_5_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_6_1_1_5> <span class="md-nav__icon md-icon"></span> UnrealEngine5 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=DeadlineRPC.html class=md-nav__link> <span class=md-ellipsis> DeadlineRPC </span> </a> </li> <li class=md-nav__item> <a href=JobPreLoad.html class=md-nav__link> <span class=md-ellipsis> JobPreLoad </span> </a> </li> <li class=md-nav__item> <a href=PluginPreLoad.html class=md-nav__link> <span class=md-ellipsis> PluginPreLoad </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> UnrealEngine5 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=UnrealEngine5.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> UnrealEngine5 </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5 class=md-nav__link> <span class=md-ellipsis> UnrealEngine5 </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess class=md-nav__link> <span class=md-ellipsis> UnrealEngineCmdManagedProcess </span> </a> <nav class=md-nav aria-label=UnrealEngineCmdManagedProcess> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess.clean_up class=md-nav__link> <span class=md-ellipsis> clean_up </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess class=md-nav__link> <span class=md-ellipsis> UnrealEngineManagedProcess </span> </a> <nav class=md-nav aria-label=UnrealEngineManagedProcess> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.clean_up class=md-nav__link> <span class=md-ellipsis> clean_up </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.render_task class=md-nav__link> <span class=md-ellipsis> render_task </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin class=md-nav__link> <span class=md-ellipsis> UnrealEnginePlugin </span> </a> <nav class=md-nav aria-label=UnrealEnginePlugin> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin.clean_up class=md-nav__link> <span class=md-ellipsis> clean_up </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.CleanupDeadlinePlugin class=md-nav__link> <span class=md-ellipsis> CleanupDeadlinePlugin </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.GetDeadlinePlugin class=md-nav__link> <span class=md-ellipsis> GetDeadlinePlugin </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=UnrealEnginePlugins/MoviePipelineDeadline/Config/index.html class=md-nav__link> <span class=md-ellipsis> UnrealEnginePlugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=UnrealSyncUtil.html class=md-nav__link> <span class=md-ellipsis> UnrealSyncUtil </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=ue_utils/rpc/base_server.html class=md-nav__link> <span class=md-ellipsis> ue_utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../version.html class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../../../server/settings/main.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5 class=md-nav__link> <span class=md-ellipsis> UnrealEngine5 </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess class=md-nav__link> <span class=md-ellipsis> UnrealEngineCmdManagedProcess </span> </a> <nav class=md-nav aria-label=UnrealEngineCmdManagedProcess> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess.clean_up class=md-nav__link> <span class=md-ellipsis> clean_up </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess class=md-nav__link> <span class=md-ellipsis> UnrealEngineManagedProcess </span> </a> <nav class=md-nav aria-label=UnrealEngineManagedProcess> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.clean_up class=md-nav__link> <span class=md-ellipsis> clean_up </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.render_task class=md-nav__link> <span class=md-ellipsis> render_task </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin class=md-nav__link> <span class=md-ellipsis> UnrealEnginePlugin </span> </a> <nav class=md-nav aria-label=UnrealEnginePlugin> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin.clean_up class=md-nav__link> <span class=md-ellipsis> clean_up </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.CleanupDeadlinePlugin class=md-nav__link> <span class=md-ellipsis> CleanupDeadlinePlugin </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.GetDeadlinePlugin class=md-nav__link> <span class=md-ellipsis> GetDeadlinePlugin </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>UnrealEngine5</h1> <div class="doc doc-object doc-module"> <a id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess class="doc doc-heading"> <code>UnrealEngineCmdManagedProcess</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=FranticX.Processes.ManagedProcess>ManagedProcess</span></code></p> <p>Process for executing unreal over commandline</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>UnrealEngineCmdManagedProcess</span><span class=p>(</span><span class=n>ManagedProcess</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Process for executing unreal over commandline</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>deadline_plugin</span><span class=p>,</span> <span class=n>process_name</span><span class=p>,</span> <span class=n>startup_dir</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Constructor</span>
<span class=sd>        :param process_name: The name of this process</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>sys</span><span class=o>.</span><span class=n>version_info</span><span class=o>.</span><span class=n>major</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
            <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span> <span class=o>=</span> <span class=n>deadline_plugin</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>process_name</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>ExitCode</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_startup_dir</span> <span class=o>=</span> <span class=n>startup_dir</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_initialize_process</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_executable</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_argument</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>CheckExitCodeCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_check_exit_code</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>StartupDirectoryCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_startup_directory</span>

    <span class=k>def</span><span class=w> </span><span class=nf>clean_up</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Called when the plugin cleanup is called</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Executing managed process cleanup.&quot;</span><span class=p>)</span>
        <span class=c1># Clean up stdout handler callbacks.</span>
        <span class=k>for</span> <span class=n>stdoutHandler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandlers</span><span class=p>:</span>
            <span class=k>del</span> <span class=n>stdoutHandler</span><span class=o>.</span><span class=n>HandleCallback</span>

        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>CheckExitCodeCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>StartupDirectoryCallback</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Managed Process Cleanup Finished.&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_initialize_process</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Called by Deadline to initialize the process.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span>
            <span class=s2>&quot;Executing managed process Initialize Process.&quot;</span>
        <span class=p>)</span>

        <span class=c1># Set the ManagedProcess specific settings.</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>PopupHandling</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandling</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>HideDosWindow</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=c1># Ensure child processes are killed and the parent process is</span>
        <span class=c1># terminated on exit</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>UseProcessTree</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>TerminateOnExit</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=n>shell</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntryWithDefault</span><span class=p>(</span><span class=s2>&quot;Shell&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>shell</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_shell</span> <span class=o>=</span> <span class=n>shell</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
            <span class=s2>&quot;.*Progress: (\d+)%.*&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_progress</span>

        <span class=c1># self.AddStdoutHandlerCallback(&quot;LogPython: Error:.*&quot;).HandleCallback += self._handle_stdout_error</span>

        <span class=c1># Get the current frames for the task</span>
        <span class=n>current_task_frames</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetCurrentTask</span><span class=p>()</span><span class=o>.</span><span class=n>TaskFrameString</span>

        <span class=c1># Set the frames sting as an environment variable</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;CURRENT_RENDER_FRAMES&quot;</span><span class=p>,</span> <span class=n>current_task_frames</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_handle_stdout_error</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Callback for when a line of stdout contains an ERROR message.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_check_exit_code</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>exit_code</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Returns the process exit code</span>
<span class=sd>        :param exit_code:</span>
<span class=sd>        :return:</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>ExitCode</span> <span class=o>=</span> <span class=n>exit_code</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_startup_directory</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Startup directory</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_startup_dir</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_handle_progress</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Handles progress reports</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>progress</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>SetProgress</span><span class=p>(</span><span class=n>progress</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_render_executable</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Get the render executable</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Setting up Render Executable&quot;</span><span class=p>)</span>

        <span class=n>executable</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;UnrealExecutable&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>executable</span><span class=p>:</span>
            <span class=n>executable</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntry</span><span class=p>(</span><span class=s2>&quot;Executable&quot;</span><span class=p>)</span>

        <span class=c1># Get the executable from the plugin</span>
        <span class=n>executable</span> <span class=o>=</span> <span class=n>RepositoryUtils</span><span class=o>.</span><span class=n>CheckPathMapping</span><span class=p>(</span><span class=n>executable</span><span class=p>)</span>
        <span class=c1># Get the project root path</span>
        <span class=n>project_root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetProcessEnvironmentVariable</span><span class=p>(</span>
            <span class=s2>&quot;ProjectRoot&quot;</span>
        <span class=p>)</span>

        <span class=c1># Resolve any `{ProjectRoot}` tokens in the environment</span>
        <span class=k>if</span> <span class=n>project_root</span><span class=p>:</span>
            <span class=n>executable</span> <span class=o>=</span> <span class=n>executable</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ProjectRoot</span><span class=o>=</span><span class=n>project_root</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>FileUtils</span><span class=o>.</span><span class=n>FileExists</span><span class=p>(</span><span class=n>executable</span><span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                <span class=s2>&quot;</span><span class=si>{executable}</span><span class=s2> could not be found&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>executable</span><span class=o>=</span><span class=n>executable</span><span class=p>)</span>
            <span class=p>)</span>

        <span class=c1># TODO: Setup getting executable from the config as well</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span>
            <span class=s2>&quot;Render Executable: </span><span class=si>{exe}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>exe</span><span class=o>=</span><span class=n>executable</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span> <span class=o>=</span> <span class=n>executable</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_render_argument</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Get the arguments to startup unreal</span>
<span class=sd>        :return:</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Setting up Render Arguments&quot;</span><span class=p>)</span>

        <span class=c1># Look for any unreal uproject paths in the process environment. This</span>
        <span class=c1># assumes a previous process resolves a uproject path and makes it</span>
        <span class=c1># available.</span>
        <span class=n>project_file</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;UnrealUProject&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_file</span><span class=p>:</span>
            <span class=n>project_file</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntry</span><span class=p>(</span><span class=s2>&quot;ProjectFile&quot;</span><span class=p>)</span>

        <span class=c1># Get any path mappings required. Expects this to be a full path</span>
        <span class=n>project_file</span> <span class=o>=</span> <span class=n>RepositoryUtils</span><span class=o>.</span><span class=n>CheckPathMapping</span><span class=p>(</span><span class=n>project_file</span><span class=p>)</span>

        <span class=c1># Get the project root path</span>
        <span class=n>project_root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetProcessEnvironmentVariable</span><span class=p>(</span>
            <span class=s2>&quot;ProjectRoot&quot;</span>
        <span class=p>)</span>

        <span class=c1># Resolve any `{ProjectRoot}` tokens in the environment</span>
        <span class=k>if</span> <span class=n>project_root</span><span class=p>:</span>
            <span class=n>project_file</span> <span class=o>=</span> <span class=n>project_file</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ProjectRoot</span><span class=o>=</span><span class=n>project_root</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_file</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;Expected project file but found `</span><span class=si>{</span><span class=n>project_file</span><span class=si>}</span><span class=s2>`&quot;</span>
            <span class=p>)</span>

        <span class=n>project_file</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>project_file</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\u201c</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s1>&#39;&quot;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span>
            <span class=s2>&quot;</span><span class=se>\u201d</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s1>&#39;&quot;&#39;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>))</span>

        <span class=c1># Check to see if the Uproject is a relative path</span>
        <span class=k>if</span> <span class=nb>str</span><span class=p>(</span><span class=n>project_file</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;../&quot;</span><span class=p>):</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;Could not find executable path to resolve relative path.&quot;</span><span class=p>)</span>

            <span class=c1># Find executable root</span>
            <span class=kn>import</span><span class=w> </span><span class=nn>re</span>
            <span class=n>engine_dir</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s2>&quot;([\s\S]*.Engine)&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>engine_dir</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;Could not find executable Engine directory.&quot;</span><span class=p>)</span>

            <span class=n>executable_root</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>engine_dir</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=o>.</span><span class=n>parent</span>

            <span class=c1># Resolve editor relative paths</span>
            <span class=n>found_paths</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>executable_root</span><span class=o>.</span><span class=n>rglob</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>project_file</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s2>&quot;../&quot;</span><span class=p>)))</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=n>found_paths</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>found_paths</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;Found multiple uprojects relative to the root directory. There should only be one when a relative path is defined.&quot;</span>
                <span class=p>)</span>

            <span class=n>project_file</span> <span class=o>=</span> <span class=n>found_paths</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;project_file:: `</span><span class=si>{</span><span class=n>project_file</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>
        <span class=c1># make sure the project exists</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>FileUtils</span><span class=o>.</span><span class=n>FileExists</span><span class=p>(</span><span class=n>project_file</span><span class=o>.</span><span class=n>as_posix</span><span class=p>()):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not find `</span><span class=si>{</span><span class=n>project_file</span><span class=o>.</span><span class=n>as_posix</span><span class=p>()</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>

        <span class=c1># Get the render arguments</span>
        <span class=n>args</span> <span class=o>=</span> <span class=n>RepositoryUtils</span><span class=o>.</span><span class=n>CheckPathMapping</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntry</span><span class=p>(</span>
                <span class=s2>&quot;CommandLineArguments&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
        <span class=p>)</span>

        <span class=n>args</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\u201c</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s1>&#39;&quot;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\u201d</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s1>&#39;&quot;&#39;</span><span class=p>)</span>

        <span class=n>startup_args</span> <span class=o>=</span> <span class=s2>&quot; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
            <span class=p>[</span>
                <span class=s1>&#39;&quot;</span><span class=si>{u_project}</span><span class=s1>&quot;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>u_project</span><span class=o>=</span><span class=n>project_file</span><span class=o>.</span><span class=n>as_posix</span><span class=p>()),</span>
                <span class=n>args</span><span class=p>,</span>
                <span class=s2>&quot;-log&quot;</span><span class=p>,</span>
                <span class=s2>&quot;-unattended&quot;</span><span class=p>,</span>
                <span class=s2>&quot;-stdout&quot;</span><span class=p>,</span>
                <span class=s2>&quot;-allowstdoutlogverbosity&quot;</span><span class=p>,</span>
            <span class=p>]</span>
        <span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span>
            <span class=s2>&quot;Render Arguments: </span><span class=si>{args}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>args</span><span class=o>=</span><span class=n>startup_args</span><span class=p>)</span>
        <span class=p>)</span>

        <span class=k>return</span> <span class=n>startup_args</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>deadline_plugin</span><span class=p>,</span> <span class=n>process_name</span><span class=p>,</span> <span class=n>startup_dir</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Constructor :param process_name: The name of this process</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>deadline_plugin</span><span class=p>,</span> <span class=n>process_name</span><span class=p>,</span> <span class=n>startup_dir</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Constructor</span>
<span class=sd>    :param process_name: The name of this process</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>sys</span><span class=o>.</span><span class=n>version_info</span><span class=o>.</span><span class=n>major</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span> <span class=o>=</span> <span class=n>deadline_plugin</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>process_name</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>ExitCode</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_startup_dir</span> <span class=o>=</span> <span class=n>startup_dir</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_initialize_process</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_executable</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_argument</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>CheckExitCodeCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_check_exit_code</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>StartupDirectoryCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_startup_directory</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineCmdManagedProcess.clean_up class="doc doc-heading"> <code class="highlight language-python"><span class=n>clean_up</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Called when the plugin cleanup is called</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>clean_up</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Called when the plugin cleanup is called</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Executing managed process cleanup.&quot;</span><span class=p>)</span>
    <span class=c1># Clean up stdout handler callbacks.</span>
    <span class=k>for</span> <span class=n>stdoutHandler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandlers</span><span class=p>:</span>
        <span class=k>del</span> <span class=n>stdoutHandler</span><span class=o>.</span><span class=n>HandleCallback</span>

    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>CheckExitCodeCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>StartupDirectoryCallback</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Managed Process Cleanup Finished.&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess class="doc doc-heading"> <code>UnrealEngineManagedProcess</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=FranticX.Processes.ManagedProcess>ManagedProcess</span></code></p> <p>Process for executing and managing an unreal jobs.</p> <p>.. note::</p> <pre><code>Although this process can auto start a batch process by
executing a script on startup, it is VERY important the command
that is executed on startup makes a connection to the Deadline RPC
server.
This will allow Deadline to know a task is running and will wait
until the task is complete before rendering the next one. If this
is not done, Deadline will assume something went wrong with the
process and fail the job after a few minutes. It is also VERY
critical the Deadline process is told when a task is complete, so
it can move on to the next one. See the Deadline RPC manager on how
this communication system works.
The reason for this complexity is, sometimes an unreal project can
take several minutes to load, and we only want to bare the cost of
that load time once between tasks.
</code></pre> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>UnrealEngineManagedProcess</span><span class=p>(</span><span class=n>ManagedProcess</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Process for executing and managing an unreal jobs.</span>

<span class=sd>    .. note::</span>

<span class=sd>        Although this process can auto start a batch process by</span>
<span class=sd>        executing a script on startup, it is VERY important the command</span>
<span class=sd>        that is executed on startup makes a connection to the Deadline RPC</span>
<span class=sd>        server.</span>
<span class=sd>        This will allow Deadline to know a task is running and will wait</span>
<span class=sd>        until the task is complete before rendering the next one. If this</span>
<span class=sd>        is not done, Deadline will assume something went wrong with the</span>
<span class=sd>        process and fail the job after a few minutes. It is also VERY</span>
<span class=sd>        critical the Deadline process is told when a task is complete, so</span>
<span class=sd>        it can move on to the next one. See the Deadline RPC manager on how</span>
<span class=sd>        this communication system works.</span>
<span class=sd>        The reason for this complexity is, sometimes an unreal project can</span>
<span class=sd>        take several minutes to load, and we only want to bare the cost of</span>
<span class=sd>        that load time once between tasks.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>process_name</span><span class=p>,</span> <span class=n>deadline_plugin</span><span class=p>,</span> <span class=n>deadline_rpc_manager</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Constructor</span>
<span class=sd>        :param process_name: The name of this process</span>
<span class=sd>        :param deadline_plugin: An instance of the plugin</span>
<span class=sd>        :param deadline_rpc_manager: An instance of the rpc manager</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>sys</span><span class=o>.</span><span class=n>version_info</span><span class=o>.</span><span class=n>major</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
            <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_initialize_process</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_executable</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_argument</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span> <span class=o>=</span> <span class=n>deadline_plugin</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=n>deadline_rpc_manager</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>process_name</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=c1># Elapsed time to check for connection</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_process_wait_time</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetConfigEntryWithDefault</span><span class=p>(</span><span class=s2>&quot;RPCWaitTime&quot;</span><span class=p>,</span> <span class=s2>&quot;300&quot;</span><span class=p>))</span>

    <span class=k>def</span><span class=w> </span><span class=nf>clean_up</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Called when the plugin cleanup is called</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Executing managed process cleanup.&quot;</span><span class=p>)</span>
        <span class=c1># Clean up stdout handler callbacks.</span>
        <span class=k>for</span> <span class=n>stdoutHandler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandlers</span><span class=p>:</span>
            <span class=k>del</span> <span class=n>stdoutHandler</span><span class=o>.</span><span class=n>HandleCallback</span>

        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Managed Process Cleanup Finished.&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_initialize_process</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Called by Deadline to initialize the process.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span>
            <span class=s2>&quot;Executing managed process Initialize Process.&quot;</span>
        <span class=p>)</span>

        <span class=c1># Set the ManagedProcess specific settings.</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>PopupHandling</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandling</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=c1># Set the stdout handlers.</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
            <span class=s2>&quot;LogPython: Error:.*&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stdout_error</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
            <span class=s2>&quot;Warning:.*&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stdout_warning</span>

        <span class=n>logs_dir</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntryWithDefault</span><span class=p>(</span>
            <span class=s2>&quot;LoggingDirectory&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span>
        <span class=p>)</span>
        <span class=c1># error handler for Apple ProRes Media not writing file</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
            <span class=s2>&quot;.*LogAppleProResMedia: Error: Failed to.*&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stdout_error</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
            <span class=s2>&quot;.*LogWindows: FPlatformMisc::RequestExitWithStatus\(1,.*&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stdout_error</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
            <span class=s2>&quot;.*with error DXGI_ERROR_DEVICE_REMOVED with Reason: DXGI_ERROR_DEVICE_HUNG*&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stdout_error</span>

        <span class=k>if</span> <span class=n>logs_dir</span><span class=p>:</span>

            <span class=n>job</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetJob</span><span class=p>()</span>

            <span class=n>log_file_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
                <span class=n>job</span><span class=o>.</span><span class=n>JobName</span><span class=p>,</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>job</span><span class=o>.</span><span class=n>JobSubmitDateTime</span><span class=o>.</span><span class=n>ToUniversalTime</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=p>,</span> <span class=s2>&quot;-&quot;</span><span class=p>),</span>
            <span class=p>)</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>log_file_dir</span><span class=p>):</span>
                <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>log_file_dir</span><span class=p>)</span>

            <span class=c1># If a log directory is specified, this may redirect stdout to the</span>
            <span class=c1># log file instead. This is a builtin Deadline behavior</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>RedirectStdoutToFile</span><span class=p>(</span>
                <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
                    <span class=n>log_file_dir</span><span class=p>,</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetSlaveName</span><span class=p>()</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=si>}</span><span class=s2>.log&quot;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=p>,</span> <span class=s2>&quot;-&quot;</span><span class=p>)</span>
                <span class=p>)</span>
            <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_handle_std_out</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>

    <span class=c1># Callback for when a line of stdout contains a WARNING message.</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_handle_stdout_warning</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogWarning</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>

    <span class=c1># Callback for when a line of stdout contains an ERROR message.</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_handle_stdout_error</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>

    <span class=k>def</span><span class=w> </span><span class=nf>render_task</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Render a task</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># Fail the render is we do not have a manager running</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;No rpc manager was running!&quot;</span><span class=p>)</span>

        <span class=c1># Start a timer to monitor the process time</span>
        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

        <span class=c1># Get temp client connection</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>get_temporary_client_proxy</span><span class=p>()</span>


        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Is server and client connected?&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_connected</span><span class=p>())</span>

        <span class=c1># Make sure we have a manager running, and we can establish a connection</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_connected</span><span class=p>():</span>
            <span class=c1># Wait for a connection. This polls the server thread till an</span>
            <span class=c1># unreal process client has connected. It is very important that</span>
            <span class=c1># a connection is established by the client to allow this process</span>
            <span class=c1># to execute.</span>
            <span class=k>while</span> <span class=nb>round</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_process_wait_time</span><span class=p>:</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=c1># keep checking to see if a client has connected</span>
                    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_connected</span><span class=p>():</span>
                        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span>
                            <span class=s2>&quot;Client connection established!!&quot;</span>
                        <span class=p>)</span>
                        <span class=k>break</span>
                <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
                    <span class=k>pass</span>

                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Waiting on client connection..&quot;</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_name</span>
                <span class=p>)</span>
                <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>

                <span class=c1># Fail the render after waiting too long</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                    <span class=s2>&quot;A connection was not established with an unreal process&quot;</span>
                <span class=p>)</span>

        <span class=c1># if we are connected, wait till the process task is marked as</span>
        <span class=c1># complete.</span>
        <span class=k>while</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_task_complete</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetCurrentTaskId</span><span class=p>()</span>
        <span class=p>):</span>
            <span class=c1># Keep flushing stdout</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_name</span><span class=p>)</span>

        <span class=c1># Flush one last time</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_name</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_render_executable</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Get the render executable</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Setting up Render Executable&quot;</span><span class=p>)</span>

        <span class=n>executable</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;UnrealExecutable&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>executable</span><span class=p>:</span>
            <span class=n>executable</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntry</span><span class=p>(</span><span class=s2>&quot;Executable&quot;</span><span class=p>)</span>

        <span class=c1># Resolve any path mappings required</span>
        <span class=n>executable</span> <span class=o>=</span> <span class=n>RepositoryUtils</span><span class=o>.</span><span class=n>CheckPathMapping</span><span class=p>(</span><span class=n>executable</span><span class=p>)</span>

        <span class=n>project_root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;ProjectRoot&quot;</span><span class=p>)</span>

        <span class=c1># If a project root is specified in the environment, it is assumed a</span>
        <span class=c1># previous process resolves the root location of the executable and</span>
        <span class=c1># presents it in the environment.</span>
        <span class=k>if</span> <span class=n>project_root</span><span class=p>:</span>
            <span class=c1># Resolve any `{ProjectRoot}` tokens present in the executable path</span>
            <span class=n>executable</span> <span class=o>=</span> <span class=n>executable</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ProjectRoot</span><span class=o>=</span><span class=n>project_root</span><span class=p>)</span>

        <span class=c1># Make sure the executable exists</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>FileUtils</span><span class=o>.</span><span class=n>FileExists</span><span class=p>(</span><span class=n>executable</span><span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not find `</span><span class=si>{</span><span class=n>executable</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span> <span class=o>=</span> <span class=n>executable</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Found executable `</span><span class=si>{</span><span class=n>executable</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_render_argument</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Get the arguments to startup unreal</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Setting up Render Arguments&quot;</span><span class=p>)</span>

        <span class=c1># Look for any unreal uproject paths in the process environment. This</span>
        <span class=c1># assumes a previous process resolves a uproject path and makes it</span>
        <span class=c1># available.</span>
        <span class=n>uproject</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;UnrealUProject&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>uproject</span><span class=p>:</span>
            <span class=n>uproject</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntry</span><span class=p>(</span><span class=s2>&quot;ProjectFile&quot;</span><span class=p>)</span>

        <span class=c1># Get any path mappings required. Expects this to be a full path</span>
        <span class=n>uproject</span> <span class=o>=</span> <span class=n>RepositoryUtils</span><span class=o>.</span><span class=n>CheckPathMapping</span><span class=p>(</span><span class=n>uproject</span><span class=p>)</span>

        <span class=c1># Get the project root path</span>
        <span class=n>project_root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;ProjectRoot&quot;</span><span class=p>)</span>

        <span class=c1># Resolve any `{ProjectRoot}` tokens in the environment</span>
        <span class=k>if</span> <span class=n>project_root</span><span class=p>:</span>
            <span class=n>uproject</span> <span class=o>=</span> <span class=n>uproject</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ProjectRoot</span><span class=o>=</span><span class=n>project_root</span><span class=p>)</span>

        <span class=n>uproject</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>uproject</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>))</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;uproject:: `</span><span class=si>{</span><span class=n>uproject</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>
        <span class=c1># Check to see if the Uproject is a relative path</span>
        <span class=k>if</span> <span class=nb>str</span><span class=p>(</span><span class=n>uproject</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;../&quot;</span><span class=p>):</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;Could not find executable path to resolve relative path.&quot;</span><span class=p>)</span>

            <span class=c1># Find executable root</span>
            <span class=kn>import</span><span class=w> </span><span class=nn>re</span>
            <span class=n>engine_dir</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s2>&quot;([\s\S]*.Engine)&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>engine_dir</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;Could not find executable Engine directory.&quot;</span><span class=p>)</span>

            <span class=n>executable_root</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>engine_dir</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=o>.</span><span class=n>parent</span>

            <span class=c1># Resolve editor relative paths</span>
            <span class=n>found_paths</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>executable_root</span><span class=o>.</span><span class=n>rglob</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>uproject</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s2>&quot;../&quot;</span><span class=p>)))</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=n>found_paths</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>found_paths</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;Found multiple uprojects relative to the root directory. There should only be one when a relative path is defined.&quot;</span>
                <span class=p>)</span>

            <span class=n>uproject</span> <span class=o>=</span> <span class=n>found_paths</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>

        <span class=c1># make sure the project exists</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>FileUtils</span><span class=o>.</span><span class=n>FileExists</span><span class=p>(</span><span class=n>uproject</span><span class=o>.</span><span class=n>as_posix</span><span class=p>()):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not find `</span><span class=si>{</span><span class=n>uproject</span><span class=o>.</span><span class=n>as_posix</span><span class=p>()</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>

        <span class=c1># Set up the arguments to startup unreal.</span>
        <span class=n>job_command_args</span> <span class=o>=</span> <span class=p>[</span>
            <span class=s1>&#39;&quot;</span><span class=si>{u_project}</span><span class=s1>&quot;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>u_project</span><span class=o>=</span><span class=n>uproject</span><span class=o>.</span><span class=n>as_posix</span><span class=p>()),</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetPluginInfoEntryWithDefault</span><span class=p>(</span><span class=s2>&quot;CommandLineArguments&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
            <span class=c1># Force &quot;-log&quot; otherwise there is no output from the executable</span>
            <span class=s2>&quot;-log&quot;</span><span class=p>,</span>
            <span class=s2>&quot;-unattended&quot;</span><span class=p>,</span>
            <span class=s2>&quot;-stdout&quot;</span><span class=p>,</span>
            <span class=s2>&quot;-allowstdoutlogverbosity&quot;</span><span class=p>,</span>
        <span class=p>]</span>

        <span class=n>arguments</span> <span class=o>=</span> <span class=s2>&quot; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>job_command_args</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Startup Arguments: `</span><span class=si>{</span><span class=n>arguments</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>arguments</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>process_name</span><span class=p>,</span> <span class=n>deadline_plugin</span><span class=p>,</span> <span class=n>deadline_rpc_manager</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Constructor :param process_name: The name of this process :param deadline_plugin: An instance of the plugin :param deadline_rpc_manager: An instance of the rpc manager</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>process_name</span><span class=p>,</span> <span class=n>deadline_plugin</span><span class=p>,</span> <span class=n>deadline_rpc_manager</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Constructor</span>
<span class=sd>    :param process_name: The name of this process</span>
<span class=sd>    :param deadline_plugin: An instance of the plugin</span>
<span class=sd>    :param deadline_rpc_manager: An instance of the rpc manager</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>sys</span><span class=o>.</span><span class=n>version_info</span><span class=o>.</span><span class=n>major</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_initialize_process</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_executable</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_render_argument</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span> <span class=o>=</span> <span class=n>deadline_plugin</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=n>deadline_rpc_manager</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>process_name</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_executable_path</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=c1># Elapsed time to check for connection</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_process_wait_time</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetConfigEntryWithDefault</span><span class=p>(</span><span class=s2>&quot;RPCWaitTime&quot;</span><span class=p>,</span> <span class=s2>&quot;300&quot;</span><span class=p>))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.clean_up class="doc doc-heading"> <code class="highlight language-python"><span class=n>clean_up</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Called when the plugin cleanup is called</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>clean_up</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Called when the plugin cleanup is called</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Executing managed process cleanup.&quot;</span><span class=p>)</span>
    <span class=c1># Clean up stdout handler callbacks.</span>
    <span class=k>for</span> <span class=n>stdoutHandler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandlers</span><span class=p>:</span>
        <span class=k>del</span> <span class=n>stdoutHandler</span><span class=o>.</span><span class=n>HandleCallback</span>

    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderExecutableCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderArgumentCallback</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Managed Process Cleanup Finished.&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEngineManagedProcess.render_task class="doc doc-heading"> <code class="highlight language-python"><span class=n>render_task</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Render a task</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>render_task</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Render a task</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Fail the render is we do not have a manager running</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;No rpc manager was running!&quot;</span><span class=p>)</span>

    <span class=c1># Start a timer to monitor the process time</span>
    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

    <span class=c1># Get temp client connection</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>get_temporary_client_proxy</span><span class=p>()</span>


    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Is server and client connected?&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_connected</span><span class=p>())</span>

    <span class=c1># Make sure we have a manager running, and we can establish a connection</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_connected</span><span class=p>():</span>
        <span class=c1># Wait for a connection. This polls the server thread till an</span>
        <span class=c1># unreal process client has connected. It is very important that</span>
        <span class=c1># a connection is established by the client to allow this process</span>
        <span class=c1># to execute.</span>
        <span class=k>while</span> <span class=nb>round</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_process_wait_time</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=c1># keep checking to see if a client has connected</span>
                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_connected</span><span class=p>():</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span>
                        <span class=s2>&quot;Client connection established!!&quot;</span>
                    <span class=p>)</span>
                    <span class=k>break</span>
            <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
                <span class=k>pass</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Waiting on client connection..&quot;</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_name</span>
            <span class=p>)</span>
            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>

            <span class=c1># Fail the render after waiting too long</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                <span class=s2>&quot;A connection was not established with an unreal process&quot;</span>
            <span class=p>)</span>

    <span class=c1># if we are connected, wait till the process task is marked as</span>
    <span class=c1># complete.</span>
    <span class=k>while</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_temp_rpc_client</span><span class=o>.</span><span class=n>is_task_complete</span><span class=p>(</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>GetCurrentTaskId</span><span class=p>()</span>
    <span class=p>):</span>
        <span class=c1># Keep flushing stdout</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_name</span><span class=p>)</span>

    <span class=c1># Flush one last time</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_name</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin class="doc doc-heading"> <code>UnrealEnginePlugin</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=Deadline.Plugins.DeadlinePlugin>DeadlinePlugin</span></code></p> <p>Deadline plugin to execute an Unreal Engine job. NB: This plugin makes no assumptions about what the render job is but has a few expectations. This plugin runs as a server in the deadline process and exposes a few Deadline functionalities over XML RPC. The managed process used by this plugin waits for a client to connect and continuously polls the RPC server till a task has been marked complete before exiting the process. This behavior however has a drawback. If for some reason your process does not mark a task complete after working on a command, the plugin will run the current task indefinitely until specified to end by the repository settings or manually.</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>UnrealEnginePlugin</span><span class=p>(</span><span class=n>DeadlinePlugin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Deadline plugin to execute an Unreal Engine job.</span>
<span class=sd>    NB: This plugin makes no assumptions about what the render job is but has a</span>
<span class=sd>    few expectations. This plugin runs as a server in the deadline process</span>
<span class=sd>    and exposes a few Deadline functionalities over XML RPC. The managed process</span>
<span class=sd>    used by this plugin waits for a client to connect and continuously polls the</span>
<span class=sd>    RPC server till a task has been marked complete before exiting the</span>
<span class=sd>    process. This behavior however has a drawback. If for some reason your</span>
<span class=sd>    process does not mark a task complete after working on a command,</span>
<span class=sd>    the plugin will run the current task indefinitely until specified to</span>
<span class=sd>    end by the repository settings or manually.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Constructor</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>sys</span><span class=o>.</span><span class=n>version_info</span><span class=o>.</span><span class=n>major</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
            <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_initialize_process</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>StartJobCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_start_job</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>RenderTasksCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_render_tasks</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>EndJobCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_end_job</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>MonitoredManagedProcessExitCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_process_exit</span>

        <span class=c1># Set the name of the managed process to the current deadline process ID</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;UnrealEngine_</span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>getpid</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=c1># Keep track of the RPC manager</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=c1># Keep track of when Job Ended has been called</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_job_ended</span> <span class=o>=</span> <span class=kc>False</span>

        <span class=c1># set the plugin to commandline mode by default. This will launch the</span>
        <span class=c1># editor and wait for the process to exit. There is no communication</span>
        <span class=c1># with the deadline process.</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span> <span class=o>=</span> <span class=kc>True</span>

    <span class=k>def</span><span class=w> </span><span class=nf>clean_up</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Plugin cleanup</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>StartJobCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderTasksCallback</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>EndJobCallback</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=o>.</span><span class=n>clean_up</span><span class=p>()</span>
            <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span>

        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>MonitoredManagedProcessExitCallback</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_on_initialize_process</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Initialize the plugin</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Initializing job plugin&quot;</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>SingleFramesOnly</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>StdoutHandling</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>PluginType</span> <span class=o>=</span> <span class=n>PluginType</span><span class=o>.</span><span class=n>Advanced</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span> <span class=o>=</span> <span class=n>StringUtils</span><span class=o>.</span><span class=n>ParseBoolean</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>GetPluginInfoEntryWithDefault</span><span class=p>(</span><span class=s2>&quot;CommandLineMode&quot;</span><span class=p>,</span> <span class=s2>&quot;true&quot;</span><span class=p>)</span>
        <span class=p>)</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
                <span class=s2>&quot;.*Progress: (</span><span class=se>\\</span><span class=s2>d+)%.*&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_progress</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>AddStdoutHandlerCallback</span><span class=p>(</span>
                <span class=s2>&quot;.*&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>HandleCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stdout</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Initialization complete!&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_on_start_job</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        This is executed when the plugin picks up a job</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=c1># Skip if we are in commandline mode</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Executing Start Job&quot;</span><span class=p>)</span>

        <span class=c1># Get and set up the RPC manager for the plugin</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_rpc_manager</span><span class=p>()</span>

        <span class=c1># Get a managed process</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span> <span class=o>=</span> <span class=n>UnrealEngineManagedProcess</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>,</span> <span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Done executing Start Job&quot;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_setup_rpc_manager</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Get an RPC manager for the plugin.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Setting up RPC Manager&quot;</span><span class=p>)</span>
        <span class=c1># Setting the port to `0` will get a random available port for the</span>
        <span class=c1># processes to connect on. This will help avoid TIME_WAIT</span>
        <span class=c1># issues with the client if the job has to be re-queued</span>
        <span class=n>port</span> <span class=o>=</span> <span class=mi>0</span>

        <span class=c1># Get an instance of the deadline rpc manager class. This class will</span>
        <span class=c1># store an instance of this plugin in the python globals. This should</span>
        <span class=c1># allow threads in the process to get an instance of the plugin without</span>
        <span class=c1># passing the data down through the thread instance</span>
        <span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=n>DeadlineRPCServerManager</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>

        <span class=c1># We would like to run the server in a thread to not block deadline&#39;s</span>
        <span class=c1># process. Get the Deadline RPC thread class. Set the class that is</span>
        <span class=c1># going to be registered on the server on the thread class</span>
        <span class=n>DeadlineRPCServerThread</span><span class=o>.</span><span class=n>deadline_job_manager</span> <span class=o>=</span> <span class=n>BaseDeadlineRPCJobManager</span>

        <span class=c1># Set the threading class on the deadline manager</span>
        <span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>threaded_server_class</span> <span class=o>=</span> <span class=n>DeadlineRPCServerThread</span>

        <span class=k>return</span> <span class=n>_deadline_rpc_manager</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_on_render_tasks</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Execute the render task</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># This starts a self-managed process that terminates based on the exit</span>
        <span class=c1># code of the process. 0 means success</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span><span class=p>:</span>
            <span class=n>startup_dir</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_startup_directory</span><span class=p>()</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span> <span class=o>=</span> <span class=n>UnrealEngineCmdManagedProcess</span><span class=p>(</span>
                <span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>,</span> <span class=n>startup_dir</span><span class=o>=</span><span class=n>startup_dir</span>
            <span class=p>)</span>

            <span class=c1># Auto execute the managed process</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>RunManagedProcess</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=p>)</span>
            <span class=n>exit_code</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=o>.</span><span class=n>ExitCode</span>  <span class=c1># type: ignore</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Process returned: </span><span class=si>{</span><span class=n>exit_code</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>exit_code</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;Process returned non-zero exit code &#39;</span><span class=si>{</span><span class=n>exit_code</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
                <span class=p>)</span>

        <span class=k>else</span><span class=p>:</span>
            <span class=c1># Flush stdout. This is useful after executing the first task</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>)</span>

            <span class=c1># Start next tasks</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>LogWarning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Starting Task </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>GetCurrentTaskId</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

            <span class=c1># Account for any re-queued jobs. Deadline will immediately execute</span>
            <span class=c1># render tasks if a job has been re-queued on the same process. If</span>
            <span class=c1># that happens get a new instance of the rpc manager</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job_ended</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_rpc_manager</span><span class=p>()</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>is_started</span><span class=p>:</span>

                <span class=c1># Start the manager</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>start</span><span class=p>(</span><span class=n>threaded</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

                <span class=c1># Get the socket the server is using and expose it to the</span>
                <span class=c1># process</span>
                <span class=n>server</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>get_server</span><span class=p>()</span>

                <span class=n>_</span><span class=p>,</span> <span class=n>server_port</span> <span class=o>=</span> <span class=n>server</span><span class=o>.</span><span class=n>socket</span><span class=o>.</span><span class=n>getsockname</span><span class=p>()</span>

                <span class=bp>self</span><span class=o>.</span><span class=n>LogWarning</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;Starting Deadline RPC Manager on port `</span><span class=si>{</span><span class=n>server_port</span><span class=si>}</span><span class=s2>`&quot;</span>
                <span class=p>)</span>

                <span class=c1># Get the port the server socket is going to use and</span>
                <span class=c1># allow other systems to get the port to the rpc server from the</span>
                <span class=c1># process environment variables</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>SetProcessEnvironmentVariable</span><span class=p>(</span>
                    <span class=s2>&quot;DEADLINE_RPC_PORT&quot;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>server_port</span><span class=p>)</span>
                <span class=p>)</span>

            <span class=c1># Fail if we don&#39;t have an instance to a managed process.</span>
            <span class=c1># This should typically return true</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>FailRender</span><span class=p>(</span><span class=s2>&quot;There is no unreal process Running&quot;</span><span class=p>)</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>MonitoredManagedProcessIsRunning</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>):</span>
                <span class=c1># Start the monitored Process</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>StartMonitoredManagedProcess</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>,</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span>
                <span class=p>)</span>

                <span class=bp>self</span><span class=o>.</span><span class=n>VerifyMonitoredManagedProcess</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>)</span>

            <span class=c1># Execute the render task</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=o>.</span><span class=n>render_task</span><span class=p>()</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>LogWarning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Finished Task </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>GetCurrentTaskId</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_on_end_job</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Called when the job ends</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>FlushMonitoredManagedProcessStdout</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>LogWarning</span><span class=p>(</span><span class=s2>&quot;EndJob called&quot;</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>ShutdownMonitoredManagedProcess</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span><span class=p>)</span>

        <span class=c1># Gracefully shutdown the RPC manager. This will also shut down any</span>
        <span class=c1># threads spun up by the manager</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>shutdown</span><span class=p>()</span>

        <span class=c1># Mark the job as ended. This also helps us to know when a job has</span>
        <span class=c1># been re-queued, so we can get a new instance of the RPC manager,</span>
        <span class=c1># as Deadline calls End Job when an error occurs</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_job_ended</span> <span class=o>=</span> <span class=kc>True</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_on_process_exit</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=c1># If the process ends unexpectedly, make sure we shut down the manager</span>
        <span class=c1># gracefully</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span><span class=o>.</span><span class=n>shutdown</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_handle_stdout</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Handle stdout</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_plugin</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_handle_progress</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Handles any progress reports</span>
<span class=sd>        :return:</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>progress</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GetRegexMatch</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>SetProgress</span><span class=p>(</span><span class=n>progress</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_startup_directory</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Get startup directory</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>startup_dir</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>GetPluginInfoEntryWithDefault</span><span class=p>(</span>
            <span class=s2>&quot;StartupDirectory&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span>
        <span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
        <span class=c1># Get the project root path</span>
        <span class=n>project_root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>GetProcessEnvironmentVariable</span><span class=p>(</span><span class=s2>&quot;ProjectRoot&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>startup_dir</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>project_root</span><span class=p>:</span>
                <span class=n>startup_dir</span> <span class=o>=</span> <span class=n>startup_dir</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ProjectRoot</span><span class=o>=</span><span class=n>project_root</span><span class=p>)</span>

            <span class=bp>self</span><span class=o>.</span><span class=n>LogInfo</span><span class=p>(</span><span class=s2>&quot;Startup Directory: </span><span class=si>{dir}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>dir</span><span class=o>=</span><span class=n>startup_dir</span><span class=p>))</span>
            <span class=k>return</span> <span class=n>startup_dir</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\\</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;/&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Constructor</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Constructor</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>sys</span><span class=o>.</span><span class=n>version_info</span><span class=o>.</span><span class=n>major</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_initialize_process</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>StartJobCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_start_job</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>RenderTasksCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_render_tasks</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>EndJobCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_end_job</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>MonitoredManagedProcessExitCallback</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_on_process_exit</span>

    <span class=c1># Set the name of the managed process to the current deadline process ID</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_unreal_process_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;UnrealEngine_</span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>getpid</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=c1># Keep track of the RPC manager</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_deadline_rpc_manager</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=c1># Keep track of when Job Ended has been called</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_job_ended</span> <span class=o>=</span> <span class=kc>False</span>

    <span class=c1># set the plugin to commandline mode by default. This will launch the</span>
    <span class=c1># editor and wait for the process to exit. There is no communication</span>
    <span class=c1># with the deadline process.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_commandline_mode</span> <span class=o>=</span> <span class=kc>True</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.UnrealEnginePlugin.clean_up class="doc doc-heading"> <code class="highlight language-python"><span class=n>clean_up</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Plugin cleanup</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span>
<span class=normal>80</span>
<span class=normal>81</span>
<span class=normal>82</span>
<span class=normal>83</span>
<span class=normal>84</span>
<span class=normal>85</span>
<span class=normal>86</span>
<span class=normal>87</span>
<span class=normal>88</span>
<span class=normal>89</span>
<span class=normal>90</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>clean_up</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Plugin cleanup</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>InitializeProcessCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>StartJobCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>RenderTasksCallback</span>
    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>EndJobCallback</span>

    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span><span class=o>.</span><span class=n>clean_up</span><span class=p>()</span>
        <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>unreal_managed_process</span>

    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>MonitoredManagedProcessExitCallback</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.CleanupDeadlinePlugin class="doc doc-heading"> <code class="highlight language-python"><span class=n>CleanupDeadlinePlugin</span><span class=p>(</span><span class=n>deadline_plugin</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Deadline call this function to run any cleanup code :param deadline_plugin: An instance of the deadline plugin</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>CleanupDeadlinePlugin</span><span class=p>(</span><span class=n>deadline_plugin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Deadline call this function to run any cleanup code</span>
<span class=sd>    :param deadline_plugin: An instance of the deadline plugin</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>deadline_plugin</span><span class=o>.</span><span class=n>clean_up</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_deadline.repository.custom.plugins.UnrealEngine5.UnrealEngine5.GetDeadlinePlugin class="doc doc-heading"> <code class="highlight language-python"><span class=n>GetDeadlinePlugin</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Deadline calls this function to get am instance of our class</p> <details class=quote> <summary>Source code in <code>client/ayon_deadline/repository/custom/plugins/UnrealEngine5/UnrealEngine5.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>GetDeadlinePlugin</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Deadline calls this function to get am instance of our class</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>UnrealEnginePlugin</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../../../../..", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "../../../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../../../../assets/javascripts/bundle.c8b220af.min.js></script> </body> </html>